# 이미지 전처리 파이프라인

## 📋 이미지 전처리 슈도코드

### 1. **라이브러리 임포트 및 초기 설정**
  * Google Colab 드라이브 마운트
  * OpenCV, NumPy, tqdm 등 이미지 처리 라이브러리
  * 멀티프로세싱 모듈 임포트

### 2. **핵심 이미지 처리 함수 정의**
  * **resize_with_padding**: 비율 유지하며 224x224로 변환
    * 원본 이미지 로드
    * 가로/세로 중 큰 쪽을 224에 맞춤 (비율 유지)
    * 작은 쪽은 검은색 패딩으로 채움
    * 중앙에 배치하여 224x224 완성

### 3. **멀티프로세싱 래퍼 함수**
  * **process_single_image**: 여러 CPU 코어 동시 처리용
  * 병렬 처리로 성능 향상

### 4. **폴더 전체 처리 함수 (훈련 데이터)**
  * **process_folder**: 클래스별 폴더 구조 유지
    * 모든 이미지 파일 검색 (.jpg, .jpeg, .png, .bmp, .tiff)
    * 원본 폴더 구조와 동일하게 출력 폴더 생성
    * 멀티프로세싱으로 빠른 처리 (기본 4개 프로세스)
    * 실시간 진행상황 표시 (tqdm)

### 5. **테스트 데이터 전용 처리 함수**
  * **process_test_folder**: 평평한 구조 처리
    * 테스트 폴더의 단일 레벨 구조 대응
    * 동일한 파일명으로 평평하게 저장

### 6. **소량 테스트 함수들**
  * **test_small_batch**: 훈련 데이터용 (최대 10개 샘플)
  * **test_small_batch_flat**: 테스트 데이터용 (평평한 구조)
  * 전체 처리 전 검증용

### 7. **경로 설정 및 실행**
  * 입력/출력 경로 설정
  * 소량 테스트 실행으로 검증
  * 전체 데이터셋 처리 실행

### 8. **결과 검증**
  * **check_results**: 처리된 이미지 크기 확인
  * **count_processed_files**: 전처리 완료 파일 개수 집계
  * 성공률 및 처리 상태 리포트

## 📌 처리 흐름

| 단계 | 내용 |
|------|------|
| **입력** | 다양한 크기의 원본 이미지 (33,137장) |
| **변환** | 비율 유지 + 검은색 패딩으로 224x224 통일 |
| **구조** | 훈련: 클래스별 폴더 유지, 테스트: 평평한 구조 |
| **병렬화** | 멀티프로세싱 (4개 코어) + 진행상황 표시 |
| **출력** | 통일된 224x224 이미지 + 폴더 구조 보존 |

## 주요 특징

- **비율 유지**: 원본 이미지 왜곡 없이 크기 통일
- **패딩 처리**: 검은색 배경으로 정사각형 완성
- **구조 보존**: 훈련 데이터의 클래스별 폴더 구조 유지
- **병렬 처리**: 멀티프로세싱으로 처리 시간 단축
- **진행 표시**: tqdm을 통한 실시간 처리 현황 확인
- **안전성**: 소량 테스트 후 전체 처리 진행

## 처리 결과

- **목표 크기**: 224x224 픽셀 (사전훈련 모델 표준)
- **지원 형식**: .jpg, .jpeg, .png, .bmp, .tiff
- **처리량**: 약 33,000장
- **성공률**: 거의 100% (파일 무결성 검증 포함)