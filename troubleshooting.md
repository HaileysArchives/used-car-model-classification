# ⚠️ Troubleshooting

> **전체 과정 보기:** [프로젝트 구조도 (영문)](https://kwonnayeon.github.io/used-car-model-classification/assets/project_architecture.html)에서 해당 이슈가 프로젝트의 어느 단계에서 발생했는지 볼 수 있습니다.

## 1. **Roboflow Auto-label 제한**
* **문제:** Roboflow에서 제공하는 **AI 기반 자동 바운딩 박스 라벨링(Auto-label)** 기능은 **유료 토큰이 필요**하여, 무료 환경에서는 사용이 불가능함
* **해결 시도:**
   * 데이터셋이 약 33,000장으로 **너무 방대하여 수작업 라벨링은 현실적으로 어려움**
   * 따라서, 초기에는 일부 이미지를 수작업으로 라벨링한 뒤, 이를 기반으로 Auto-label 기능을 활용해 전체 라벨 품질을 높이는 **준지도 학습 전략**을 계획함
   * 그러나 Roboflow의 Auto-label 기능이 **유료 토큰 기반**임을 확인하고 해당 방식은 **보류**
* **결과:**
   * YOLO 기반 Object Detection 전략은 중단하고, 라벨링 없이도 가능한 **Image Classification 기반 모델(EfficientNet, ResNet 등)** 로 전략을 전환하여 학습 진행

## 2. **Colab 환경의 리소스 및 시간 제약**
* **문제:** 전체 33,000장의 데이터를 처리하기에는 Colab(Pro 포함)의 메모리 및 세션 시간 한계로 인해 학습이 매우 느리게 진행됨
* **해결 시도:**
   * 처음에는 **EfficientNetB7** 모델을 사용해 전체 데이터를 학습하려 했으나, **1 epoch에 약 4시간 이상 소요**
   * `checkpoint` 기능 구현 및 best model 저장 로직 작성했지만, 세션 타임만료로 무의미해짐
* **결과:**
   * 현실적인 시간과 리소스를 고려해 해당 방식은 **중단**
   * 대신, 전체 데이터셋에서 **10,000장만 샘플링**하여 소규모 학습 환경으로 전환

## 3. **GPU 세션 끊김 및 학습 시간 제약**
- **문제:** Colab 환경에서 학습 도중 **예고 없이 GPU 세션이 끊기는 현상**이 발생하여 장시간 학습이 필요한 모델 실험이 어려움
- **해결 시도:**
    - Colab Pro 유료 요금제를 통해 **고성능 GPU 환경으로 업그레이드**하여 효율적인 학습을 시도
    - **EfficientNetB7** 모델을 다시 학습했으나, **1 epoch당 약 2시간 이상 소요**되어 여전히 실험 반복이 어려움
    - **ResNet** 모델의 경우 한 에폭당 **3시간 소요**되어 동일한 시간 제약 문제 직면
    - 시간 제약 해결을 위한 추가 조치: **EfficientNet 에폭 수를 50에서 20으로 단축**, **ResNet 에폭 수를 25에서 5로 대폭 단축**
- **결과:**
    - 학습 중단 시점 복구를 위해 **`checkpoint` 기능과 best model 저장 로직**을 구현했으나, 세션 시간 초과로 실질적 활용 어려움
    - EfficientNet의 경우 **경량화된 EfficientNetB0 모델로 전환**하여 진행
    - ResNet의 경우 **데이터 샘플링(10,000장)과 에폭 수 단축(25→5)** 전략으로 시간 제약 해결
    - 단축된 학습으로 인한 **모델 수렴 부족 및 성능 저하 가능성** 존재하나, 제한된 환경에서 실현 가능한 최적해로 판단

## 4. **샘플링으로 인한 클래스 누락**
* **문제:** 전체 데이터셋(33,137장, 396개 클래스)에서 **10,000장만 랜덤 샘플링**하여 소규모 학습 환경으로 전환한 결과, 테스트셋 예측 시 **일부 셀이 비어있는 결과**가 발생
* **샘플링 조건:**
   * **랜덤 샘플링** 방식으로 10,000장 선별
   * **각 폴더당 최소 20장** 확보를 목표로 설정
   * **노이즈 이미지 제거** 작업을 통해 품질 관리 진행
* **원인 분석:**
   * 랜덤 샘플링으로 인해 **일부 클래스의 데이터가 부족**하거나 아예 누락
   * 학습하지 못한 클래스에 대해 모델이 **예측값을 생성하지 못함**
* **결과:**
   * submission.csv에서 **특정 클래스에 대한 예측값 누락** 확인 → 누락된 클래스의 예측값을 0으로 채워 넣는 방식으로 보완
   * **GPU 사용 제한과 시간 제약**으로 인해 전체 데이터셋 사용 불가능
   * 제한된 환경에서 **샘플링된 데이터로 학습 진행**

---

# 🔧 기술적 개선사항

## 환경 및 리소스 최적화
* Google Colab Pro+ 또는 AWS/GCP 클라우드 환경 활용하여 **더 안정적이고 지속적인 학습 환경 확보**
* 장시간 학습에 대비해 **자동 저장/재시작 가능한 환경 구성** (예: Checkpoint 관리, 세션 자동 재연결 스크립트 등)

## 데이터 활용 고도화
* 데이터 증강(Augmentation)을 적용하여 적은 학습량에서도 **다양한 패턴 학습 가능**
* 전체 데이터셋 활용을 목표로, **샘플링 방식 보완 또는 분산 학습(Multi-GPU, TPU) 환경 구축** 필요

## 파일 제출 자동화 및 검증 절차 강화
* `submission.csv` 생성 단계에서 **클래스 누락 여부 자동 검출 로직 추가**
* 예측 확률이 존재하지 않는 클래스에 대해서는 **자동으로 0으로 채워 제출 포맷 유지**

---

# 📈 모델링 전략 개선

## 모델 경량화 및 최적화
* EfficientNetB0 외에도 **MobileNet** 등 경량화된 모델로 확장 테스트 가능
* 학습 속도를 고려해 **모델 크기 대비 성능이 우수한 구조 탐색**

## 앙상블 및 하이브리드 접근
* ResNet, EfficientNet 등 다양한 모델의 **앙상블 기법 적용**으로 성능 향상 기대
* 향후 가능하다면 Object Detection과 Classification을 결합한 **하이브리드 파이프라인 재도입** 가능성 열어둘 것

## 최신 아키텍처 도입
* Vision Transformer (ViT), ConvNeXt 등 최신 구조에 대한 사전 학습 모델 탐색 및 적용 시도
* 특히 더 높은 성능을 기대할 수 있는 ConvNeXt와 같은 고용량 모델은 향후 사양이 충분한 환경에서 도입 고려
* 리소스가 허용되는 경우 무거운 모델을 활용한 정확도 극대화 전략 병행